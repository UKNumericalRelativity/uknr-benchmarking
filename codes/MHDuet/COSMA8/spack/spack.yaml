# This is a Spack Environment file.
#
# It describes a set of packages to be installed, along with
# configuration settings.
spack:
  modules:
    prefix_inspections:
      include:
      - CPATH
      lib:
      - LD_LIBRARY_PATH
      - LIBRARY_PATH
      lib64:
      - LD_LIBRARY_PATH
      - LIBRARY_PATH
    default:
      roots:
        tcl: $spack/../spack-modules-20241030
      enable:
      - tcl
      tcl:
        projections:
          all: '{name}/{version}/{compiler.name}-{compiler.version}'
          ^mpi: '{name}/{version}/{^mpi.name}-{^mpi.version}-{compiler.name}-{compiler.version}'
        all:
          autoload: direct
          # prerequisites: direct
          conflict:
          - '{name}'
        openmpi:
          environment:
            set:
              # copied from /cosma/local/Modules/modulefiles/mpi/openmpi/5.0.3
              OMPI_MCA_btl: ^openib,uct
        kadath:
          environment:
            set:
              FUKA_ROOT: '{prefix}'
  # add package specs to the `specs` list
  specs:
    - matrix:
        - [amrex]
        - ['+openmp','~openmp']
    - kadath +mpi
  view: false
  concretizer:
    unify: when_possible
  compilers:
  - compiler:
      spec: gcc@=14.1.0
      paths:
        cc: /cosma/local/gcc/14.1.0/bin/gcc
        cxx: /cosma/local/gcc/14.1.0/bin/g++
        f77: /cosma/local/gcc/14.1.0/bin/gfortran
        fc: /cosma/local/gcc/14.1.0/bin/gfortran
      flags: {}
      operating_system: rocky9
      target: x86_64
      modules: []
      environment: {}
      extra_rpaths: []
  - compiler:
      spec: gcc@=11.4.1
      paths:
        cc: /usr/bin/gcc
        cxx: /usr/bin/g++
        f77: /usr/bin/gfortran
        fc: /usr/bin/gfortran
      flags: {}
      operating_system: rocky9
      target: x86_64
      modules: []
      environment: {}
      extra_rpaths: []
  packages:
    mpi:
      buildable: False
    all:
      compiler: [gcc@14.1.0]
      # providers:
      #   mpi: [openmpi@5.0.3]
    diffutils:
      externals:
      - spec: diffutils@3.7
        prefix: /usr
    m4:
      externals:
      - spec: m4@1.4.19
        prefix: /usr
    openssl:
      externals:
      - spec: openssl@3.0.7
        prefix: /usr
    gettext:
      externals:
      - spec: gettext@0.21
        prefix: /usr
    libtool:
      externals:
      - spec: libtool@2.4.6
        prefix: /usr
    perl:
      externals:
      - spec: perl@5.32.1~cpanm+opcode+open+shared+threads
        prefix: /usr
    pkgconf:
      externals:
      - spec: pkgconf@1.7.3
        prefix: /usr
    texinfo:
      externals:
      - spec: texinfo@6.7
        prefix: /usr
    binutils:
      externals:
      - spec: binutils@2.35.2~gold+headers
        prefix: /usr
    findutils:
      externals:
      - spec: findutils@4.8.0
        prefix: /usr
    doxygen:
      externals:
      - spec: doxygen@1.9.1+graphviz~mscgen
        prefix: /usr
    git:
      externals:
      - spec: git@2.43.5+tcltk
        prefix: /usr
    zlib:
      externals:
      - spec: zlib@1.2.11
        prefix: /usr
    cmake:
      externals:
      - spec: cmake@3.26.5
        prefix: /usr
    coreutils:
      externals:
      - spec: coreutils@8.32
        prefix: /usr
    gawk:
      externals:
      - spec: gawk@5.1.0
        prefix: /usr
    curl:
      externals:
      - spec: curl@7.76.1+gssapi+nghttp2
        prefix: /usr
    tar:
      externals:
      - spec: tar@1.34
        prefix: /usr
    automake:
      externals:
      - spec: automake@1.16.2
        prefix: /usr
    openssh:
      externals:
      - spec: openssh@8.7p1
        prefix: /usr
    autoconf:
      externals:
      - spec: autoconf@2.69
        prefix: /usr
    flex:
      externals:
      - spec: flex@2.6.4+lex
        prefix: /usr
    cvs:
      externals:
      - spec: cvs@1.11.23
        prefix: /usr
    subversion:
      externals:
      - spec: subversion@1.14.1
        prefix: /usr
    gmake:
      externals:
      - spec: gmake@4.3
        prefix: /usr
    groff:
      externals:
      - spec: groff@1.22.4
        prefix: /usr
    sed:
      externals:
      - spec: sed@4.8
        prefix: /usr
    bison:
      externals:
      - spec: bison@3.7.4
        prefix: /usr
    openmpi:
      externals:
      - spec: openmpi@5.0.3 #+lustre +static +thread_multiple +romio +orterunprefix
        prefix: /cosma/local/openmpi/gnu_14.1.0/5.0.3
    hdf5:
      externals:
      - spec: hdf5@1.14.4 +fortran +mpi +hl
        prefix: /cosma/local/parallel-hdf5/gnu_14.1.0_ompi_5.0.3/1.14.4
    fftw:
      externals:
      - spec: fftw@3.3.10 +mpi +openmp
        prefix: /cosma/local/fftw/gnu_14.1.0_ompi_5.0.3/3.3.10-epyc
    python:
      externals:
      - spec: python@3.12.4
        prefix: /cosma/local/Python/3.12.4
    gsl:
      externals:
      - spec: gsl@2.8
        prefix: /cosma/local/gsl/2.8
    pgplot:
      externals:
      - spec: pgplot@5.2.2
        prefix: /cosma/local/pgplot/5.2.2
    amrex:
      require:
      - +hdf5 +tiny_profile +plotfile_tools +shared dimensions=2,3 build_type=RelWithDebInfo
